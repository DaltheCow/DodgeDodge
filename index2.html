<!DOCTYPE html>
<html>
  <body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/88/three.min.js" charset="utf-8"></script>
    <canvas id="myCanvas"></canvas>
    <script type="text/javascript">
    (function() {

    function roughSizeOfObject( object ) {

        var objectList = [];
        var stack = [ object ];
        var bytes = 0;

        while ( stack.length ) {
            var value = stack.pop();

            if ( typeof value === 'boolean' ) {
                bytes += 4;
            }
            else if ( typeof value === 'string' ) {
                bytes += value.length * 2;
            }
            else if ( typeof value === 'number' ) {
                bytes += 8;
            }
            else if
            (
                typeof value === 'object'
                && objectList.indexOf( value ) === -1
            )
            {
                objectList.push( value );

                for( var i in value ) {
                    stack.push( value[ i ] );
                }
            }
        }
        return bytes;
    }

        const renderer = new THREE.WebGLRenderer({canvas: document.getElementById("myCanvas"), antialias: true});
        renderer.setClearColor(0xCCCCCC);
        renderer.setPixelRatio(window.devicePixelRatio);
        renderer.setSize(window.innerWidth, window.innerHeight);

        const camera = new THREE.PerspectiveCamera(35, window.innerWidth / window.innerHeight, 0.1, 700);
        const scene = new THREE.Scene();

        const light = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(light);
        const light1 = new THREE.PointLight(0xffffff, 0.5);
        scene.add(light1);

        camera.position.y = 15;
        camera.rotation.x = -.1;

        const addCube = (x, y, z, scene, size = 10) => {
          const mesh = new THREE.Mesh(geometry, material);
          mesh.position.set(x, y, z);
          scene.add(mesh);
          return mesh;
        }

        let cubeArray = []
        const geometry = new THREE.CubeGeometry(10, 10, 10);
        const material = new THREE.MeshLambertMaterial({color: 0xF3FFE2});
        setInterval(() => {
          const x = Math.random() * 1000 - 500
          const z = - Math.random() * 1000
          cubeArray.push(addCube(x, 0, z, scene, 10));
        }, 10)

        setInterval(() => {
          for (var i = 0; i < cubeArray.length; i++) {
            scene.remove(cubeArray[i])
            cubeArray[i].geometry.dispose()
          }
          cubeArray = []
        }, 4000)

        requestAnimationFrame(render);

        let then = Date.now();
        let count = 0;
        
        function render() {
          if (Date.now() - then >= 1000) {
            console.log(count);
            then = Date.now();
            count = 0;
          }
          count++;
          renderer.render(scene, camera);
          requestAnimationFrame(render);
        }

      })()
    </script>
  </body>
</html>
